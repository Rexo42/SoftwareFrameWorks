<app-nav-bar></app-nav-bar>

<div class="container mt-4">
  <div class="row">
    <!-- Group List Sidebar -->
    <div class="col-md-2">
      <div class="border p-2" style="height: 300px; overflow-y: auto; background-color: #e9ecef;">
        <h6 class="text-center">Groups</h6>
        <ul class="list-group">
          <li *ngFor="let group of groups" class="list-group-item py-1">
            {{ group }}
          </li>
        </ul>
      </div>
    </div>

    <!-- Chat Section (Middle Column) -->
    <div [ngClass]="userRole === 'SuperAdmin' ? 'col-md-7' : 'col-md-8 mx-auto'">
      <div>
        <strong>Channel:</strong> {{ channelName }}
      </div>
      
      <!-- Scrollable Chat Messages -->
      <div #scrollContainer
           class="border p-3 mb-3"
           style="height: 300px; overflow-y: auto; background-color: #f8f9fa;">
        <div *ngFor="let msg of messages">
          <p class="mb-1">
            ({{ msg.getFormattedTime() }}) {{ msg.sender }}: {{ msg.message }}
          </p>
        </div>
      </div>

      <!-- Message Input Form -->
      <form (ngSubmit)="sendMessage()">
        <div class="mb-3">
          <label for="message" class="form-label">Message:</label>
          <input
            type="text"
            id="message"
            name="message"
            class="form-control"
            [(ngModel)]="message"
            placeholder="Enter your message"
            required>
        </div>
        <div class="d-grid">
          <button type="submit" class="btn btn-primary">Send</button>
        </div>
      </form>
    </div>

    <!-- SuperAdmin Extra Panel (Right Column) -->
    <div *ngIf="userRole === 'SuperAdmin'" class="col-md-3">
      <!-- Toggle Button -->
      <div class="d-grid mb-3">
        <button class="btn btn-secondary" (click)="toggleAdminPanel()">
          Admin Panel (On/Off)
        </button>
      </div>

      <!-- Toggleable Admin Panel Content -->
      <div *ngIf="showAdminPanel">
        <!-- Create Account Component -->
        <app-create-account></app-create-account>

        <!-- Styled Create Group Form -->
        <div class="container mt-4">
          <form 
            (ngSubmit)="createGroup()" 
            class="container p-4 border rounded shadow-sm bg-light" 
            style="max-width: 500px;"
          >
            <h3 class="mb-4 text-center">Create Group</h3>

            <div class="mb-3">
              <label for="groupName" class="form-label">Group Name:</label>
              <input 
                type="text" 
                class="form-control" 
                id="groupName" 
                [(ngModel)]="groupName" 
                name="groupName" 
                placeholder="Enter group name"
                required
              />
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-primary">Create Group</button>
            </div>

            <div *ngIf="errorMsg" class="mt-3 alert alert-info text-center" id="errorMsg">
              {{ errorMsg }}
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>